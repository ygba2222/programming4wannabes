Hi Everybody!

Inspired by @TheDoctor I started working in a small side project involving some crackme’s, and I would appreciate your feedback/comments (if the binary works on your system, how easy/difficult you found the challenger,…)

The program is encoded at the end of this post. To get the binary, save the text below in a file named c1.bin and then run:

cat c1.bin | base64 -d | gunzip > c1
chmod +x c1
The objective is to get the success message not necessarily finding the password.

Looking forward to your feedback.

THE CODE
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

A little help… A version without symbols stripped + a hint

Hint: Look for strncmp

NEW CODE
H4sIACu8RFcAA+1Zf3RTVx2/Lz/a0EJe9kMFmZIhaJEtNNp56ATWsKS9kYyVrR0CgyzNjzaSHzV9
DwqDjS6U7S1EOR7dYUfPRJ06PR6HcyJDDqQU+mPTURhuTOZkuM2EoJThaMewz++9776QPInHP/zH
c3yH13vv537v98fn+733vTwednkadRyH1EuHFiEycnINdNzA8GcsBRHA5iMD/K1GJiprRMVXQ0n7
ZTMqaRGy0r9kXQXpqHotD5S0NzF4d0Gvss7Abitz2cr8VNtZTFptDaxd9o4QqET/+aW6RdbfCLce
7qalrejCtBujr0qfmffsmpptT+78inlJ3VfnerH07nKcbpkwYekjL5mtKPtjoARLg9k2HUJ/b8XS
O1janMWSeFpqfWPQdYUozjtSrivYP4JTrixOT9YVjbgRfk8tjJ/sO/sJbiR5unLOiDJ1mk4h++hj
XNJ1hQORL7re2PTr1f3URPKclZohKpIZ6LvG89NxMjrOATS+jxCGpYGDpM3+Hf4SFH/RlRVPDTMF
h7eAgp3g5w6pdTtOu0aIPHE2exS4680Ik/FgRoYr14voehBw7YL2JLTPUAcl127qgOTam3KNSq5M
yvWz5OkxyfUz0LcLS4cOACVIUSopSicxpfnP41TrDli9s+BmI/yVgBjqSvHSpbCUMLZTdf2cBVwf
pyEB77MrSKyHlCHTRYq8IF0rbX4D4hw5OK26AWVfAOsH55Les9DDg65xK2L8gLKlhCvJNYpTdxED
o/sQZfJlMnd4AuQll0J6ulkm85CkAbJ6yq7JVkQXWK8uOP8PMHUbMeUkplJTktcQOmwkxIiTDy4h
gtMJN1UHvaTPE08F0jNCby/xZLh/94LnEf/rjFt6kTfihZtgYh0/drI5mwO+VkgmnByS+3ej3Gsw
sZvLjRC78lF7pucvMg8m+84bcK8smPCx81jO5C/2O1pg7JautN4rLMMp7zjuPSVg3PMh7HaE0/HR
9bdg6U+UMyydJyxLr9szF3+KU4bf18LuxdIttHVLzlmjeR5Lb4LYqtWO+3NnICzSgST0yvdi6cNl
/FaZRJ1+2IKTMs9vu0BGPTKxxD/6I5K1e8DMb8hmfKwPv/JnYriB8jb5iGLrCO4dFte67MMOiPIX
M+3yPrJTD5D9mw2QXZgcBzf7+K1PUHoNfyXL7Mf3EgE8dhEUEs7H/gS5s2fqRzZXY+5NOYOlukX5
C/ZM73HefQjvxPyz/XjQQI8cnOLwoNJj2vI23NPPE309f0ajsizYXpgJ08wn6g+QYJezJwyk14eT
H8hCFZZWmHDaYclPyTpA3SCaDHL2zMpVq/uxdAEsHiVZmWI/jqUhPDaG60dFOF6O5jJQcc1Zc/ES
yieW3ieUOpr5rX8gFnsv8VuHKLkPUXLXW7KvI3VR7pdXiV5/XfavUJT7VJLP5M04/YQSzxkSD051
jeP6V/mt36CLJuiihZDUbB2p/l5g64gQxKkG2B1LQLIP801DkBY4LZI5C62RNy8+TZnOZ78LpvIe
nP4prb30g6Mv0HOp5x1qSTqb3aNXksZv9dAK6wCWvmzJT8sGYaX9VN4CkQljK1atxtJY7peArcTS
SSBtbyekoh+njIsmwYaSJrC0CA82mWiiBpvocT7YNFXJW1PNQR0gORvY


OK, strings does not work on this one. I did it on purpose as I think everybody will know how to do that by now.

In this case, it is better to use the second dump (the one with symbols). This one contains the symbols, so you can see the libc functions called by the application. You can approach the crack in two main ways.

Opening the binary in a debugger and start setting breakpoints to figure out where the key is used and how is it used.
Use objdump -d to get a assembler dump of the binary and to static analysis
In any case, when you find the relevant part of the program you will have to patch the binary. Actually finding the password is a bit tricky…

Hope this helps. I will be posting a solution tomorrow or the day after if nobody does it earlier.

Thanks for the feedback on the difficulty, this is very useful

After extracting the ELF binary, open it up in a disassembler
Perform a strings analysis and locate any obvious strings’ position(s) in the executable code
Find the conditional ‘jz’ instruction and patch it with an unconditional jmp, i.e. bytes 74 05 should become EB 05
???
Profit!
